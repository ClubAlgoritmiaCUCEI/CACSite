{"version":3,"sources":["Components/popup/index.js","Components/user-box/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","Components/searchUsers/index.js","Components/select-users/index.js","Views/attendance/index.js"],"names":["Popup","children","className","TopPopup","onClick","useEffect","timeOut","setTimeout","clearTimeout","UserBox","user","redirect","history","useHistory","push","id","src","photoURL","DefaultImage","alt","displayName","to","rank","rating","_toConsumableArray","arr","Array","isArray","arrayLikeToArray","iter","Symbol","iterator","Object","from","unsupportedIterableToArray","TypeError","SearchUsers","handleUserClick","allUsers","useContext","AllUsersContext","useState","setDisplayName","canFilter","setCanFilter","match","setMatch","lastQuery","setLastQuery","isCFLoading","query","toLocaleLowerCase","users","filter","includes","type","value","placeholder","onChange","e","target","map","i","key","SelectUsers","close","handleConfirm","setUsers","handleEvent","window","addEventListener","removeEventListener","findIndex","u","removeUser","length","Attendance","props","atnContext","AttendanceContext","UserContext","usersMap","setRedirect","inList","setInList","popupOpen","setPopupOpen","open","description","alert","setAlert","preview","classData","code","params","pushData","a","classRef","firestore","doc","undefined","attendances","find","attendance","uid","update","firebase","FieldValue","arrayUnion","logged","isLoading","isDataAvailable","active","setClassData","c","validCode","endClass","title","date","toDate","toDateString","speakers","speaker","attendant","console","log","isAdmin"],"mappings":"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","file":"static/js/9.b4889915.chunk.js","sourcesContent":["import React, { useEffect } from \"react\";\r\n\r\nimport \"./style.css\";\r\n\r\nconst Popup = ({ children }) => {\r\n  return <div className=\"cac_popup\">{children}</div>;\r\n};\r\n\r\nexport default Popup;\r\n\r\nconst TopPopup = ({ children, className = \"error\", onClick = () => null }) => {\r\n  useEffect(() => {\r\n    const timeOut = setTimeout(() => {\r\n      onClick();\r\n    }, 5000);\r\n    return () => clearTimeout(timeOut);\r\n  });\r\n\r\n  return (\r\n    <div\r\n      onClick={onClick}\r\n      className={`cac_popup-top ${className ? className : \"\"}`}\r\n    >\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport { TopPopup };\r\n","import React from \"react\";\r\nimport ColoredName from \"../colored-name\";\r\n\r\n// eslint-disable-next-line no-unused-vars\r\nimport { BrowserRouter as Router, Link, useHistory } from \"react-router-dom\";\r\n\r\nimport DefaultImage from \"../../assets/default-photo.jpg\";\r\n\r\nimport \"./style.css\";\r\n\r\nconst UserBox = ({ user, className, onClick, redirect = true }) => {\r\n  const history = useHistory();\r\n  return (\r\n    <div\r\n      className={`cac_user-box ${className || \"\"} ${\r\n        !redirect ? \"cac_user-box--redirect\" : \"\"\r\n        }`}\r\n      onClick={onClick}\r\n    >\r\n      <img\r\n        onClick={() => redirect && history.push(`/profile/${user.id}`)}\r\n        className=\"cac_user-box_photo\"\r\n        src={user.photoURL || DefaultImage}\r\n        alt={user.displayName}\r\n      />\r\n      <div className=\"cac_user-box_text\">\r\n        {redirect ? (\r\n          <Link to={`/profile/${user.id}`} className=\"cac_user-box_name--link\">\r\n            <ColoredName rank={user.rank} className=\"cac_user-box_name\">\r\n              {user.displayName}\r\n            </ColoredName>\r\n          </Link>\r\n        ) : (\r\n            <ColoredName rank={user.rank} className=\"cac_user-box_name\">\r\n              {user.displayName}\r\n            </ColoredName>\r\n          )}\r\n\r\n        <ColoredName rank={user.rank} className=\"cac_user-box_ranking\">\r\n          {user.rating || \"\"}\r\n        </ColoredName>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserBox;\r\n","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import React, { useContext, useState, useEffect } from \"react\";\r\nimport { AllUsersContext } from \"../../Providers/userProvider\";\r\n\r\nimport UserBox from \"../user-box\";\r\n\r\nimport \"./style.css\";\r\n\r\nconst SearchUsers = ({ handleUserClick }) => {\r\n  const allUsers = useContext(AllUsersContext);\r\n  const [displayName, setDisplayName] = useState(\"\");\r\n  const [canFilter, setCanFilter] = useState(true);\r\n  const [match, setMatch] = useState([]);\r\n  const [lastQuery, setLastQuery] = useState();\r\n\r\n  useEffect(() => {\r\n    if (!allUsers.isCFLoading && canFilter && lastQuery !== displayName) {\r\n      setCanFilter(false);\r\n      setLastQuery(displayName);\r\n      const query = displayName.toLocaleLowerCase();\r\n      setMatch(\r\n        allUsers.users.filter(user =>\r\n          user.displayName.toLocaleLowerCase().includes(query)\r\n        )\r\n      );\r\n      setTimeout(() => {\r\n        setCanFilter(true);\r\n      }, 250);\r\n    }\r\n  }, [displayName, canFilter, lastQuery, allUsers]);\r\n\r\n  return (\r\n    <div className=\"cac_search-user\">\r\n      <input\r\n        type=\"text\"\r\n        className=\"cac_search-user_input\"\r\n        value={displayName}\r\n        placeholder=\"User name\"\r\n        onChange={e => setDisplayName(e.target.value)}\r\n      />\r\n      <div className=\"cac_search_users-container\">\r\n        {match.map((user, i) => (\r\n          <UserBox redirect={false} key={i} user={user} onClick={() => handleUserClick(user)} />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchUsers;\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\nimport SearchUsers from \"../searchUsers\";\r\nimport UserBox from \"../user-box\";\r\nimport Button from \"../button\";\r\nimport \"./style.css\";\r\n\r\nconst SelectUsers = ({ close, handleConfirm }) => {\r\n  const [users, setUsers] = useState([]);\r\n\r\n  const handleUserClick = user => {\r\n    if (users.findIndex(u => u.id === user.id) === -1)\r\n      setUsers([...users, user]);\r\n  };\r\n\r\n  const removeUser = user => {\r\n    setUsers(users.filter(u => u.id !== user.id));\r\n  };\r\n\r\n  const handleConfirmClick = () => {\r\n    if (users.length > 0) {\r\n      handleConfirm(users);\r\n      close();\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    const handleEvent = e => {\r\n      if (e.key === \"Escape\") close();\r\n    };\r\n    window.addEventListener(\"keydown\", handleEvent);\r\n    return () => {\r\n      window.removeEventListener(\"keydown\", handleEvent);\r\n    };\r\n  }, [close]);\r\n\r\n  return (\r\n    <div className=\"cac_select-users\">\r\n      <SearchUsers handleUserClick={handleUserClick} />\r\n      <span className=\"cac_select-users_title\">Selected</span>\r\n      <div className=\"cac_select-users_users\">\r\n        {users.map(user => (\r\n          <UserBox\r\n            redirect={false}\r\n            key={user.id}\r\n            user={user}\r\n            onClick={() => removeUser(user)}\r\n          />\r\n        ))}\r\n      </div>\r\n      <div className=\"cac_select-users_button-container\">\r\n        <Button\r\n          onClick={close}\r\n          className=\"cac_select-users_button cac_select-users_button--cancel\"\r\n        >\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          onClick={handleConfirmClick}\r\n          className={`cac_select-users_button cac_select-users_button ${\r\n            users.length > 0\r\n              ? \"\"\r\n              : \"cac_select-users_button-container--disabled\"\r\n          }`}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SelectUsers;\r\n","import React, { useState, useEffect, useContext } from \"react\";\r\nimport {\r\n  // eslint-disable-next-line no-unused-vars\r\n  BrowserRouter as Router,\r\n  Redirect,\r\n  useHistory\r\n} from \"react-router-dom\";\r\nimport { firebase, firestore } from \"../../firebase\";\r\n\r\nimport { AttendanceContext } from \"../../Providers/attendanceProvider\";\r\nimport { UserContext, AllUsersContext } from \"../../Providers/userProvider\";\r\n\r\nimport UserBox from \"../../Components/user-box\";\r\nimport Button from \"../../Components/button\";\r\nimport Popup, { TopPopup } from \"../../Components/popup\";\r\nimport SelectUsers from \"../../Components/select-users\";\r\n\r\nimport \"./style.css\";\r\n\r\nconst Attendance = props => {\r\n  const atnContext = useContext(AttendanceContext);\r\n  const user = useContext(UserContext);\r\n  const { usersMap } = useContext(AllUsersContext);\r\n  const [redirect, setRedirect] = useState(false);\r\n  const [inList, setInList] = useState(false);\r\n  const [popupOpen, setPopupOpen] = useState(false);\r\n  const [alert, setAlert] = useState({\r\n    open: false,\r\n    description: \"\",\r\n    type: \"\"\r\n  });\r\n  const { preview } = props;\r\n  const history = useHistory();\r\n\r\n  const classData = preview ? props.classData : atnContext.classData;\r\n  const { code } = props.match.params || classData;\r\n  useEffect(() => {\r\n    const pushData = async () => {\r\n      const classRef = firestore.doc(`class/${code}`);\r\n      if (\r\n        classData.attendances.find(attendance => attendance.id === user.uid) ===\r\n        undefined\r\n      ) {\r\n        await classRef.update({\r\n          attendances: firebase.firestore.FieldValue.arrayUnion({\r\n            id: user.uid,\r\n            displayName: user.displayName\r\n          })\r\n        });\r\n      }\r\n      setInList(true);\r\n    };\r\n    if (\r\n      !preview &&\r\n      user.logged &&\r\n      !user.isLoading &&\r\n      classData.isDataAvailable &&\r\n      !inList &&\r\n      classData.active\r\n    ) {\r\n      pushData();\r\n    }\r\n  }, [inList, user, classData, code, preview]);\r\n\r\n  useEffect(() => {\r\n    if (!preview) {\r\n      if (code !== classData.code) {\r\n        atnContext.setClassData(c => ({ ...c, code }));\r\n      } else {\r\n        if (!classData.validCode) {\r\n          setRedirect(true);\r\n        }\r\n      }\r\n    }\r\n  }, [code, user, classData, atnContext, preview]);\r\n\r\n  const handleConfirm = async users => {\r\n    setPopupOpen(false);\r\n    const classRef = firestore.doc(`class/${code}`);\r\n    await classRef.update({\r\n      attendances: firebase.firestore.FieldValue.arrayUnion(\r\n        ...users.map(user => ({ id: user.id, displayName: user.displayName }))\r\n      )\r\n    });\r\n  };\r\n\r\n  const handleAdd = () => {\r\n    if (!preview) {\r\n      setPopupOpen(true);\r\n    }\r\n  };\r\n\r\n  const endClass = async () => {\r\n    if (!preview && classData.active) {\r\n      const classRef = firestore.doc(`class/${code}`);\r\n      await classRef.update({\r\n        active: false\r\n      });\r\n    }\r\n  };\r\n\r\n  const changeClass = () => {\r\n    console.log(atnContext);\r\n    history.push('/attendance');\r\n    atnContext.setClassData({ isDataAvailable: false, code: \"\" });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (classData.isDataAvailable && !classData.active) {\r\n      setAlert({ open: true, type: \"error\", description: \"Class ended\" });\r\n    }\r\n  }, [classData.isDataAvailable, classData.active]);\r\n\r\n  return (\r\n    <div className=\"cac_attendance cac_attendance--in-class\">\r\n      {alert.open && (\r\n        <TopPopup\r\n          onClick={() => setAlert({ open: false })}\r\n          className={alert.type}\r\n        >\r\n          {alert.description}\r\n        </TopPopup>\r\n      )}\r\n      {redirect && <Redirect to=\"/attendance\" />}\r\n      {popupOpen && (\r\n        <Popup>\r\n          <SelectUsers\r\n            close={() => setPopupOpen(false)}\r\n            handleConfirm={handleConfirm}\r\n          />\r\n        </Popup>\r\n      )}\r\n      {(classData.isDataAvailable || preview) && (\r\n        <div className=\"cac_attendance_class\">\r\n          <h3 className=\"cac_attendance_title\">{classData.title}</h3>\r\n          <span className=\"cac_attendance_date\">\r\n            {preview ? classData.date : classData.date.toDate().toDateString()}\r\n          </span>\r\n          <div className=\"cac_attendance_code-container\">\r\n            <span className=\"cac_attendance_code-title\">Code</span>\r\n            <span className=\"cac_attendance_code-code\">{classData.code}</span>\r\n          </div>\r\n          <div className=\"cac_attendance_speakers-container\">\r\n            <span className=\"cac_attendance_speakers-title\">Speakers</span>\r\n            {classData.speakers.map((speaker, i) => (\r\n              <UserBox\r\n                key={i}\r\n                className=\"cac_attendance_speaker_user-box\"\r\n                user={usersMap[speaker.id] || speaker}\r\n              />\r\n            ))}\r\n          </div>\r\n          <div className=\"cac_attendance_description-container\">\r\n            <p className=\"cac_attendance_description-title\">Description</p>\r\n            <p className=\"cac_attendance_description-text\">\r\n              {classData.description}\r\n            </p>\r\n          </div>\r\n          <div className=\"cac_attendance_attendant-container\">\r\n            {classData.attendances.map((attendant, i) => (\r\n              <UserBox\r\n                key={i}\r\n                className=\"cac_attendance_attendant\"\r\n                user={usersMap[attendant.id] || attendant}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"cac_attendance_buttons\">\r\n        <Button\r\n          className=\"cac_attendance_button cac_attendance_add\"\r\n          onClick={changeClass}\r\n        >\r\n          Change\r\n        </Button>\r\n        {user.isAdmin && (\r\n          <>\r\n            <Button\r\n              className=\"cac_attendance_button cac_attendance_end\"\r\n              onClick={endClass}\r\n            >\r\n              End class\r\n            </Button>\r\n            <Button\r\n              className=\"cac_attendance_button cac_attendance_add\"\r\n              onClick={handleAdd}\r\n            >\r\n              Add people\r\n            </Button>\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Attendance;\r\n"],"sourceRoot":""}